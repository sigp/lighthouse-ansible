---
- name: Migrates a docker-compose node over to a compiled setup
  hosts:
    - boot_nodes
    - validators
    - developers
  roles:
    - common
    - geth
    - rust
    - lighthouse
  gather_facts:
      false
  tasks:
    - name: Build Geth from source
      include_tasks: roles/geth/tasks/build-from-source.yml
    - name: Configure systemd for Geth
      include_tasks: roles/geth/tasks/configure-systemd.yml
    - name: Start Geth systemd service
      include_tasks: roles/geth/tasks/start.yml
    - name: Install Rust
      include_tasks: roles/rust/tasks/install.yml
    - name: Build Lighthouse from source
      include_tasks: roles/lighthouse/tasks/build-from-source.yml
    - name: Configure systemd for Lighthouse
      include_tasks: roles/lighthouse/tasks/configure-systemd.yml
    - name: Start Beacon Node
      include_tasks: roles/lighthouse/tasks/bn-start.yml
    - name: Start Validator Client
      include_tasks: roles/lighthouse/tasks/vc-start.yml
