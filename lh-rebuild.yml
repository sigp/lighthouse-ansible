---
- name: Update repo and rebuild Lighthouse
  roles:
    - common
    - lighthouse
  hosts:
    - lighthouse_bn
    - lighthouse_vc
  vars_files:
    - ./secret.yml
  gather_facts:
    false
  tasks:

    - name: Build Lighthouse from source
      when: "'lighthouse_bn' in group_names or 'lighthouse_vc' in group_names"
      include_tasks: roles/lighthouse/tasks/build-from-source.yml

    - name: Configure systemd for Lighthouse
      when: "'lighthouse_bn' in group_names or 'lighthouse_vc' in group_names"
      include_tasks: roles/lighthouse/tasks/configure-systemd.yml
